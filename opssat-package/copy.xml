<project name="OPS-SAT package" default="copyfiles" basedir=".">
  <target name="copyfiles">
    <!-- TODO - ideally most of space-common should be copied once and symlinks used -->
    <copy todir="${esa.nmf.mission.opssat.assembly.outputdir}/home/nmf/supervisor">
      <fileset dir="${basedir}/src/main/resources/space-common"/>
      <fileset dir="${basedir}/src/main/resources/space-supervisor-opssat-root"/>
      <filterset>
        <filter token="MAIN_CLASS_NAME" value="esa.mo.nmf.provider.NanoSatMOSupervisorOPSSATImpl"/>
        <filter token="APPS_DIR" value="../.."/>
        <filter token="NMF_LIB" value="`cd ../lib > /dev/null; pwd`/*"/>
      </filterset>
      <firstmatchmapper>
        <globmapper from="startscript.sh" to="supervisor.sh"/>
        <globmapper from="*" to="*"/>
      </firstmatchmapper>
    </copy>
    <copy todir="${esa.nmf.mission.opssat.assembly.outputdir}/home/payloads-test">
      <fileset dir="${basedir}/src/main/resources/space-common"/>
      <fileset dir="${basedir}/src/main/resources/space-app-root"/>
      <filterset>
        <filter token="MAIN_CLASS_NAME" value="esa.mo.nmf.apps.PayloadsTestApp"/>
        <filter token="APID" value="1504"/>
        <filter token="NMF_LIB" value="`cd ../nmf/lib > /dev/null; pwd`/*"/>
      </filterset>
      <firstmatchmapper>
        <globmapper from="startscript.sh" to="start_payloads-test.sh"/>
        <globmapper from="*" to="*"/>
      </firstmatchmapper>
    </copy>
    <chmod dir="${esa.nmf.mission.opssat.assembly.outputdir}" perm="ugo+rx" includes="**/*.sh"/>
  </target>
</project>
